# slg游戏框架

游戏大致功能分为:

1. 城建功能;
2. 多层大地图(ECS框架);
3. 战斗PVE;
4. 外围系统;

## 客户端

代码框架整体是基于服务的框架;

### 1.城建功能系统

### 2.外围UI系统

使用MVVM框架进行UI开发,设置

### 3.核心战斗

### 4.大地图
Lod:分层结构+ECS框架

显示层级(0-4)|逻辑层级(0-5)
-|-
0: 城建 | 0
1级地图 | 1-2
2级地图 | 3
3级地图 | 4-5
* 存在优化点

system:系统
MainObject:
以MainBuilding开头的system是城建相关的;
以World开头的system是大地图相关系统
city:主城
Base:
Filters:筛选器(城建使用)
GameEventState:城建事件
LodBaseSystem:

### 5.其他系统:

#### 1.音效功能:AudioSystem.cs服务

a.通过切面AOP代码切入对应逻辑代码位置,播放音效;
b.角色音效在对应的模型预制件上,通过timeline进行播放;

#### 2.多语言系统
* 语言设置放在登录界面最合适,这应该作为一个初始配置选择;切换语言后,刷新界面;修改参数,通知会服务器,更新资源

* 多语言文本:通过策划配置表,可临时使用程序代码临时配置
* 多语言资源:
    1. 包中包含所有不同语言的资源;加载时加载对应语言的资源
    2. 下载更新对应语言的资源

### 6.快速开发相关工具
#### 1.资源管理:
1. 资源格式检测:美术制作的贴图/模型/特效等资源可能对游戏运行有很大影响,需要程序制作相关检测工具和规范格式等处理;

* 贴图:图片格式统一为sprite/texture2D等,大小最好做成2的幂的格式最大一般不超2048;不能做成2的幂,则大小尽量可以被4整除(android);一般ui要加载的图片,打图集,可以提前生成好sprite的asset资源,进入游戏则加载到内存;
* 特效:涉及到渲染相关的性能问题,制作相关工具,严格控制mat和shader的性能检测;
* 模型:主要限制模型面数和顶点数,低模(一般不超过3000面,极限一般不超过5000)和高模(尽量控制在2万面以下);

#### 2.协议工具:
a. 使用pb,导出client的lua协议;
b. 通过pb文件里添加相关注解,实现协议直接转换为数据结构(Inject),自定义相关方法(Meta)来关联Inject的数据结构;同时直接实现同步刷新数据(Inject)并抛出事件,来处理相关逻辑(sync);
<!-- c. 额外增加了mute,不处理相关 -->

#### 3.战斗编辑器:
1.技能编辑器:
2.战斗模拟:
3.英雄编辑:

#### 4.剧情插件:

#### 5.新手引导工具:
做一套游戏专用的新手引导,通过策划配置来修改新手引导,加快开发流程;
#### 6.打包工具:
一键打包:使用jenkins,配置一台专门的打包机进行打包;
#### 7.导表工具:
策划配置excel数据,导入工程(.lua/.json等)